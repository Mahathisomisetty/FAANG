<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ElectroMart</title>
  <link rel="stylesheet" href="index.css">
</head>
<body>

  <nav id="navbar"></nav>

  <div id="notification">
    <span id="notif-text"></span>
    <button class="close-btn" onclick="hideNotification()">×</button>
  </div>

  <section id="electronics-section">
    <h1 style="text-align:center; margin:20px 0;">Products</h1>
    <div id="electronics"></div>
  </section>

  <section id="cart-section" style="display:none;">
    <h1 style="text-align:center; margin:20px 0;">Your Cart</h1>
    <div id="cart"></div>
    <div class="total" id="totalPrice"></div>
  </section>

  <section id="login" style="display:none;">
    <h2>Login</h2> 
    <form id="loginForm">
      <input type="text" id="username" placeholder="Username" required>
      <input type="password" id="password" placeholder="Password" required>
      <button type="submit">Login</button>
      <p>Create Account? <a onclick="showSection('register')">Register</a></p>
    </form>
  </section>

  <section id="register" style="display:none;">
    <h2>Register</h2>
    <form id="registerform">
      <input type="text" placeholder="Full Name" id="name" required>
      <input type="email" placeholder="example@gmail.com" id="email" required>
      <input type="password" id="reg-password" placeholder="Password" required>
      <input type="tel" id="phonenumber" placeholder="XXXXXXXXXX" required>
      <button type="submit">Create Account</button>
      <p>Already having Account? <a onclick="showSection('login')"><span class="llink">Login</span></a></p>
    </form>
  </section>

  <script>
    // Navbar
    function renderNavbar() {
      document.getElementById("navbar").innerHTML = `
        <ol>
          <li class="logo">ElectroMart</li>
          <li><a onclick="showSection('electronics')">Home</a></li>
          <li><a onclick="showSection('cart')">Cart (<span id="cart-count">0</span>)</a></li>
          <li><a onclick="showSection('login')">Login</a></li>
        </ol>
      `;
    }
    renderNavbar();

    // Sections toggle
    function showSection(section) {
      document.getElementById("electronics-section").style.display = section === "electronics" ? "block" : "none";
      document.getElementById("cart-section").style.display = section === "cart" ? "block" : "none";
      document.getElementById("login").style.display = section === "login" ? "block" : "none";
      document.getElementById("register").style.display = section === "register" ? "block" : "none";
      if (section === "cart") renderCart();
    }

    // Products
    let electronics = document.getElementById("electronics");
    fetch("https://fakestoreapi.com/products")
      .then(res => res.json())
      .then(products => {
        products.forEach(product => display(product));
        updateCartCount();
      });

    function display(product) {
      let card = document.createElement("div");
      card.classList.add("product-card");
      card.innerHTML = `
        <img src="${product.image}" alt="${product.title}">
        <h3>${product.title}</h3>
        <p class="price">$${product.price}</p>
        <p>${product.description.substring(0, 60)}...</p>
        <div class="button-group">
          <button class="add-to-cart">Add to Cart</button>
          <button class="buy-now">Buy Now</button>
        </div>
      `;
      card.querySelector(".add-to-cart").addEventListener("click", () => addToCart(product));
      card.querySelector(".buy-now").addEventListener("click", () => showNotification("⚡ Buying " + product.title + " ..."));
      electronics.appendChild(card);
    }

    // Cart
    function addToCart(product) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      let exists = cart.some(item => item.id === product.id);
      if (!exists) cart.push(product);
      localStorage.setItem("cart", JSON.stringify(cart));
      updateCartCount();
      showNotification("✅ " + product.title + " added to cart!");
    }

    function updateCartCount() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      document.getElementById("cart-count").textContent = cart.length;
    }

    function renderCart() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      let cartDiv = document.getElementById("cart");
      let totalDiv = document.getElementById("totalPrice");
      cartDiv.innerHTML = "";
      let total = 0;

      if (cart.length === 0) {
        cartDiv.innerHTML = "<p>Your cart is empty</p>";
        totalDiv.innerHTML = "";
        return;
      }

      cart.forEach((item, index) => {
        total += parseFloat(item.price);
        let div = document.createElement("div");
        div.classList.add("cart-item");
        div.innerHTML = `
          <img src="${item.image}" alt="${item.title}">
          <h3>${item.title}</h3>
          <p>$${item.price}</p>
          <button onclick="removeItem(${index})">Remove</button>
        `;
        cartDiv.appendChild(div);
      });

      totalDiv.innerHTML = "Total: $" + total.toFixed(2);
      let payBtn = document.createElement("button");
      payBtn.textContent = "Proceed to pay";
      payBtn.classList.add("buy-now");
      payBtn.onclick = () => alert("Proceeding to payment!");
      totalDiv.appendChild(payBtn);
    }

    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
      updateCartCount();
    }

    // Notification
    function showNotification(message) {
      let notif = document.getElementById("notification");
      document.getElementById("notif-text").textContent = message;
      notif.style.display = "flex";
    }
    function hideNotification() {
      document.getElementById("notification").style.display = "none";
    }
  </script>
</body>
</html>
